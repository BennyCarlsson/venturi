{"version":3,"sources":["views/Favorite/index.tsx","views/Destination/index.tsx","views/NotFound/index.tsx","api/vasttrafik/helpers.ts","api/vasttrafik/vasttrafik.ts","views/StartPage/styles.ts","views/StartPage/index.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["Favorites","Destination","NotFound","getExpireTime","secondsToExpires","date","Date","setSeconds","getSeconds","getTime","now","toISOString","substr","time","toTimeString","isTokenValid","token","accessToken","expires","getDepartureBoard","fromStopId","a","updateToken","fetchDepartureBoard","response","status","json","data","tripUrl","fetch","method","headers","Authorization","fetchAccessToken","body","expires_in","access_token","Heading","styled","h1","StartPage","useState","departures","setDepartures","error","setError","getTimeTable","useCallback","DepartureBoard","Departure","console","log","useEffect","errorText","length","map","departure","stop","name","direction","track","rtTime","App","className","exact","path","Favorite","to","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.0efe5862.chunk.js","sourcesContent":["import React from 'react';\n\nfunction Favorites() {\n  return (\n    <div>\n      Favorites\n    </div>\n  );\n}\n\nexport default Favorites;\n","import React from 'react';\n\nfunction Destination() {\n  return (\n    <div>\n      Destination\n    </div>\n  );\n}\n\nexport default Destination;\n","import React from 'react';\n\nfunction NotFound() {\n  return (\n    <div>\n      404\n    </div>\n  );\n}\n\nexport default NotFound;\n","import { Token } from './vasttrafik';\nexport const getExpireTime = (secondsToExpires: any) => {\n  let date = new Date();\n  date.setSeconds(date.getSeconds() + secondsToExpires);\n  return date;\n};\n\nexport const getTime = () => {\n  const now = new Date();\n  const date = now.toISOString().substr(0, 10);\n  const time = now.toTimeString().substr(0, 5);\n  return { date, time };\n};\n\nexport const isTokenValid = (token: Token) => {\n  if (!token.accessToken) return false;\n  if (token.expires && token.expires < new Date()) return false;\n  return true;\n};\n","import { getTime, getExpireTime, isTokenValid } from './helpers';\n\nexport type Token = {\n  accessToken: string;\n  expires: null | Date;\n};\n\nexport type ApiError = {\n  DepartureBoard: {\n    error: string;\n    errorText: string;\n    noNamespaceSchemaLocation: string;\n  };\n};\n\nexport type DepartureBoard = {\n  DepartureBoard: {\n    Departure: Departure[];\n    noNamespaceSchemaLocation: string;\n    serverdate: string;\n    servertime: string;\n  };\n};\n\nexport type Departure = {\n  JourneyDetailRef: { ref: string };\n  accessibility: string;\n  bgColor: string;\n  date: string;\n  direction: string;\n  fgColor: string;\n  journeyNumber: string;\n  journeyid: string;\n  name: string;\n  rtDate: string;\n  rtTime: string;\n  sname: string;\n  stop: string;\n  stopid: string;\n  stroke: string;\n  time: string;\n  track: string;\n  type: string;\n};\n\nconst id = 'T0hDc2txdEp6cDhMYlVmRjhsaWVfeERHdDBBYTp6ME5wWWY3dlYxbUFhTEVFbkdyRFprTGEwODBh';\nlet token: Token = { accessToken: '', expires: null };\n\nexport const getDepartureBoard = async (fromStopId: string) => {\n  let data;\n  if (!isTokenValid(token)) {\n    await updateToken();\n  }\n  let response = await fetchDepartureBoard(fromStopId);\n  if (response.status === 401) {\n    await updateToken();\n    response = await fetchDepartureBoard(fromStopId);\n  }\n  if (response.status === 200) {\n    data = await response.json();\n    return data as DepartureBoard;\n  }\n  data = await response.json();\n  return data as ApiError;\n};\n\nconst fetchDepartureBoard = async (fromStopId: string): Promise<Response> => {\n  const { date, time } = getTime();\n  const tripUrl = `https://api.vasttrafik.se/bin/rest.exe/v2/departureBoard?id=${fromStopId}&date=${date}&time=${time}&format=json`;\n  const response = await fetch(tripUrl, {\n    method: 'GET',\n    headers: {\n      Authorization: `Bearer ${token.accessToken}`\n    }\n  });\n  return response;\n};\n\nconst fetchAccessToken = async () => {\n  const response = await fetch('https://api.vasttrafik.se:443/token', {\n    headers: {\n      Authorization: `Basic ${id}`,\n      'Content-Type': 'application/x-www-form-urlencoded'\n    },\n    method: 'POST',\n    body: 'grant_type=client_credentials'\n  });\n  const data = await response.json();\n  return data;\n};\n\nconst updateToken = async () => {\n  const data = await fetchAccessToken();\n  const expires = getExpireTime(data.expires_in);\n  const accessToken = data.access_token;\n  token = { accessToken, expires };\n};\n","import styled from 'styled-components'\n\nexport const Heading = styled.h1`\n  font-size: 64px;\n`\n","import { getDepartureBoard, DepartureBoard, Departure, ApiError } from 'api/vasttrafik/vasttrafik';\nimport React, { useCallback, useEffect, useState } from 'react';\nimport { Heading } from './styles';\n\nconst spaldingsgatan = '9021014006160000';\n//const nordstan = '9021014004945000';\n\nfunction StartPage() {\n  const [departures, setDepartures] = useState<Departure[]>([]);\n  const [error, setError] = useState<ApiError | null>(null);\n\n  const getTimeTable = useCallback(async () => {\n    const data = await getDepartureBoard(spaldingsgatan);\n    if ((data as ApiError).DepartureBoard.error) {\n      setError(data as ApiError);\n    } else {\n      setDepartures((data as DepartureBoard).DepartureBoard.Departure);\n    }\n    console.log(data);\n  }, []);\n\n  useEffect(() => {\n    getTimeTable();\n  }, [getTimeTable]);\n\n  const renderDepartures = () => {\n    return departures.map((departure) => {\n      return (\n        <div>\n          <h2>{departure.stop}</h2>\n          <h3>{`${departure.name} ${departure.direction}`}</h3>\n          <p>Spår: {departure.track}</p>\n          <p>Tid: {departure.time}</p>\n          <p>Förväntad Tid: {departure.rtTime}</p>\n        </div>\n      );\n    });\n  };\n\n  return (\n    <div>\n      <Heading>Departs</Heading>\n      {error && <h2>{error.DepartureBoard.error}</h2>}\n      {error && <p>{error.DepartureBoard.errorText}</p>}\n      {departures.length > 1 && renderDepartures()}\n    </div>\n  );\n}\n\nexport default StartPage;\n","import React from 'react';\nimport './App.css';\nimport {\n  BrowserRouter as Router,\n  Switch,\n  Route,\n  Link\n} from \"react-router-dom\";\n\nimport Favorites from 'views/Favorite';\nimport Destination from 'views/Destination';\nimport NotFound from 'views/NotFound';\nimport StartPage from 'views/StartPage';\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <Router>\n      <div>\n        <Switch>\n          <Route exact path=\"/\">\n            <StartPage />\n          </Route>\n          <Route path=\"/favorites\">\n            <Favorites/>\n          </Route>\n          <Route path=\"/destination\">\n            <Destination />\n          </Route>\n          <Route path=\"*\">\n            <NotFound />\n          </Route>\n        </Switch>\n\n        <nav>\n          <ul>\n            <li>\n              <Link to=\"/\">Home</Link>\n            </li>\n            <li>\n              <Link to=\"/favorites\">About</Link>\n            </li>\n            <li>\n              <Link to=\"/destination\">Users</Link>\n            </li>\n          </ul>\n        </nav>\n      </div>\n    </Router>\n    </div>\n  );\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}